<!doctype html><html lang="ja"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>リアルタイムグラフジェネレーター</title><style>body{font-family:system-ui,-apple-system,'Segoe UI',Roboto,'Noto Sans JP',sans-serif;padding:18px;background:#f7f7fb}.wrap{max-width:980px;margin:0 auto;background:#fff;padding:18px;border-radius:12px;box-shadow:0 6px 18px rgba(10,10,20,0.06)}h1{font-size:20px;margin:0 0 12px}label{display:block;margin:10px 0 6px;font-weight:600}input,select,textarea,button{font-size:14px;padding:8px;border-radius:8px;border:1px solid #ddd;box-sizing:border-box}textarea{min-height:80px}.row{display:flex;gap:12px;flex-wrap:wrap}.col{flex:1;min-width:220px}.controls{display:flex;gap:8px;margin-top:12px}canvas{background:transparent;border-radius:8px;max-width:100%}.extra-settings{margin-top:12px;padding:12px;border:1px solid #ddd;border-radius:8px;background:#f9f9f9;display:none}.minmax-inline{display:flex;gap:8px;align-items:flex-end}.minmax-inline .field{display:flex;flex-direction:column;flex:0 0 140px}.minmax-inline .field label{font-weight:600;font-size:12px;margin-bottom:6px}.minmax-inline .field input{width:100%}@media(max-width:560px){.minmax-inline{flex-direction:column}.minmax-inline .field{flex:1}}</style></head><body><div class="wrap"><h1>リアルタイムグラフジェネレーター</h1><p>名前とデータを入力して「生成」を押すとグラフが作れます。</p><div class="row"><div class="col"><label>名前（改行ごとに1つ）</label><textarea id="labelsInput">東京\n大阪\n名古屋\n札幌\n福岡</textarea></div><div class="col"><label>データ（改行ごとに1つ）</label><textarea id="dataInput">120\n95\n78\n55\n66</textarea></div></div><div class="row"><div class="col"><label>グラフ種別</label><select id="chartType"><option value="bar">棒グラフ</option><option value="line">折れ線グラフ</option><option value="pie">円グラフ</option><option value="doughnut">ドーナツ</option><option value="radar">レーダーチャート</option><option value="polarArea">極座標グラフ</option><option value="bubble">バブルチャート</option></select></div><div class="col"><label>タイトル（省略可）</label><input id="titleInput" placeholder="売上表 2025年"></div><div class="col"><label>色設定モード</label><select id="colorMode"><option value="auto">自動</option><option value="single">単色</option><option value="custom">自由に指定</option></select><div id="colorExtra" style="margin-top:10px;display:none"><label>カスタム色（カンマ区切り）</label><input id="customColors" placeholder="#ff0000,#00ff00,#0000ff"><label style="margin-top:6px;">背景色（透過の場合は空欄）</label><input type="color" id="bgColor" value="#ffffff"><label style="margin-top:6px;">フォント</label><select id="fontSelect"><option value="Arial">Arial</option><option value="Verdana">Verdana</option><option value="Courier New">Courier New</option><option value="Noto Sans JP">Noto Sans JP</option><option value="Roboto">Roboto</option><option value="Oswald">Oswald</option><option value="Montserrat">Montserrat</option><option value="Lobster">Lobster</option></select><input type="file" id="uploadFont" accept=".ttf,.otf,.woff,.woff2"></div></div></div><div class="extra-settings" id="extraSettings"><div id="lineSettings" style="display:none;margin-top:10px"><label>線の太さ（折れ線グラフのみ）</label><input id="lineWidth" type="number" value="2" min="1" max="10"></div><div id="bubbleSettings" style="display:none;margin-top:10px"><label>バブルサイズ（カンマ区切り）</label><input id="bubbleSizes" placeholder="10,20,15"></div></div><div class="extra-settings" id="barSettings" style="margin-top:12px;display:none"><label>棒グラフ最大値（任意）</label><input id="barMax" type="number" placeholder="200"><label style="margin-top:10px;">値の省略（範囲外を非表示）</label><div class="minmax-inline" style="margin-top:6px"><div class="field"><label>最小値</label><input id="omitMin" type="number" placeholder="10"></div><div class="field"><label>最大値</label><input id="omitMax" type="number" placeholder="200"></div></div></div><div class="controls"><button id="generateBtn">生成</button><button id="downloadBtn" disabled>PNGでダウンロード</button><button id="copyBtn" disabled>コピー</button><button id="resetBtn">リセット</button></div><canvas id="chartCanvas" width="800" height="450"></canvas></div><script src="https://cdn.jsdelivr.net/npm/chart.js"></script><script>const labelsInput=document.getElementById('labelsInput'),dataInput=document.getElementById('dataInput'),chartTypeSel=document.getElementById('chartType'),titleInput=document.getElementById('titleInput'),colorMode=document.getElementById('colorMode'),customColors=document.getElementById('customColors'),lineWidthInput=document.getElementById('lineWidth'),bubbleSizesInput=document.getElementById('bubbleSizes'),barMaxInput=document.getElementById('barMax'),omitMinInput=document.getElementById('omitMin'),omitMaxInput=document.getElementById('omitMax'),bgColorInput=document.getElementById('bgColor'),fontSelect=document.getElementById('fontSelect'),uploadFont=document.getElementById('uploadFont'),extraSettings=document.getElementById('extraSettings'),lineSettings=document.getElementById('lineSettings'),barSettings=document.getElementById('barSettings'),bubbleSettings=document.getElementById('bubbleSettings'),colorExtra=document.getElementById('colorExtra'),generateBtn=document.getElementById('generateBtn'),downloadBtn=document.getElementById('downloadBtn'),copyBtn=document.getElementById('copyBtn'),resetBtn=document.getElementById('resetBtn'),ctx=document.getElementById('chartCanvas').getContext('2d');let chart=null,uploadedFontName=null;function parseInputs(){const labels=labelsInput.value.split('\n').map(t=>t.trim()).filter(t=>t),values=dataInput.value.split('\n').map(t=>Number(t.trim())).filter(v=>!isNaN(v));return{labels,values}}function generateColors(n){const out=[];for(let i=0;i<n;i++){const h=Math.floor((i*137.5)%360);out.push(`hsl(${h}deg 70% 55%)`)}return out}function repeatColors(colors,n){if(colors.length===0)return generateColors(n);const out=[];for(let i=0;i<n;i++)out.push(colors[i%colors.length]);return out}uploadFont.addEventListener('change',e=>{const file=e.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=function(evt){const fontData=evt.target.result;const fontName=file.name.split('.')[0];const style=document.createElement('style');style.innerHTML=`@font-face { font-family:'${fontName}'; src:url(${fontData}); }`;document.head.appendChild(style);uploadedFontName=fontName;fontSelect.value=fontName};reader.readAsDataURL(file)});function updateExtraSettings(){extraSettings.style.display=(chartTypeSel.value==='line'||chartTypeSel.value==='bubble')?'block':'none';lineSettings.style.display=chartTypeSel.value==='line'?'block':'none';bubbleSettings.style.display=chartTypeSel.value==='bubble'?'block':'none';barSettings.style.display=chartTypeSel.value==='bar'?'block':'none';colorExtra.style.display='block'}function renderChart(){const parsed=parseInputs();if(parsed.labels.length===0||parsed.values.length===0)return;if(chart)chart.destroy();let dataset={label:titleInput.value||'データ',data:parsed.values,borderWidth:1};if(colorMode.value==='single'){dataset.backgroundColor=['hsl(220deg 70% 60%)'];dataset.borderColor=['hsl(220deg 70% 40%)']}else if(colorMode.value==='custom'){const colors=customColors.value.split(',').map(c=>c.trim()).filter(c=>c);const repeated=repeatColors(colors,parsed.values.length);dataset.backgroundColor=repeated;dataset.borderColor=repeated}else{const auto=generateColors(parsed.values.length);dataset.backgroundColor=auto;dataset.borderColor=auto}if(chartTypeSel.value==='line')dataset.borderWidth=Number(lineWidthInput.value)||2;if(chartTypeSel.value==='bubble'){const sizes=bubbleSizesInput.value.split(',').map(n=>Number(n.trim()));dataset.data=parsed.values.map((v,i)=>({x:i,y:v,r:sizes[i]||10}))}let finalLabels=parsed.labels,finalValues=parsed.values;if(chartTypeSel.value==='bar'){const omitMin=omitMinInput.value?Number(omitMinInput.value):null,omitMax=omitMaxInput.value?Number(omitMaxInput.value):null,newL=[],newV=[];parsed.values.forEach((v,i)=>{if((omitMin===null||v>=omitMin)&&(omitMax===null||v<=omitMax)){newL.push(parsed.labels[i]);newV.push(v)}});finalLabels=newL;finalValues=newV;dataset.data=finalValues}chart=new Chart(ctx,{type:chartTypeSel.value,data:{labels:finalLabels,datasets:[dataset]},options:{responsive:true,animation:(chartTypeSel.value==='bar'||chartTypeSel.value==='line')?{duration:1000,easing:'easeOutBounce'}:{},plugins:{title:{display:!!titleInput.value,text:titleInput.value,font:{family:uploadedFontName||fontSelect.value}},legend:{display:['pie','doughnut','radar','polarArea'].includes(chartTypeSel.value),labels:{font:{family:uploadedFontName||fontSelect.value}}}},scales:(['pie','doughnut','polarArea'].includes(chartTypeSel.value))?{}:{y:{beginAtZero:true,max:(chartTypeSel.value==='bar'&&barMaxInput.value)?Number(barMaxInput.value):undefined,ticks:{font:{family:uploadedFontName||fontSelect.value}}},x:{ticks:{font:{family:uploadedFontName||fontSelect.value}}}}}});downloadBtn.disabled=false;copyBtn.disabled=false}generateBtn.addEventListener('click',()=>{updateExtraSettings();renderChart()});chartTypeSel.addEventListener('change',updateExtraSettings);colorMode.addEventListener('change',()=>{updateExtraSettings();renderChart()});customColors.addEventListener('input',renderChart);lineWidthInput.addEventListener('input',renderChart);bubbleSizesInput.addEventListener('input',renderChart);barMaxInput.addEventListener('input',renderChart);omitMinInput.addEventListener('input',renderChart);omitMaxInput.addEventListener('input',renderChart);bgColorInput.addEventListener('input',renderChart);fontSelect.addEventListener('change',renderChart);downloadBtn.addEventListener('click',()=>{const url=document.getElementById('chartCanvas').toDataURL('image/png');const a=document.createElement('a');a.href=url;a.download=(titleInput.value.trim()||'chart')+'.png';a.click()});copyBtn.addEventListener('click',()=>{const canvas=document.getElementById('chartCanvas');canvas.toBlob(async(blob)=>{try{await navigator.clipboard.write([new ClipboardItem({'image/png':blob})]);alert('コピーしました')}catch(e){alert('コピー失敗')}})});resetBtn.addEventListener('click',()=>{labelsInput.value='';dataInput.value='';titleInput.value='';chartTypeSel.value='bar';customColors.value='';if(chart)chart.destroy();downloadBtn.disabled=true;copyBtn.disabled=true;updateExtraSettings()});updateExtraSettings();</script></body></html>
